<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <meta name="renderer" content="webkit">
    <meta name='apple-mobile-web-app-capable' content='yes' />
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name='format-detection' content='telephone=no' />
    <meta name='format-detection' content='email=no' />
    <!--去掉移动端input聚焦默认背景-->
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="wap-font-scale" content="no">
    <title>谁是点钞王</title>
    <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico"/>
    <link rel="stylesheet" type="text/css" href="../../styles/games/common.css">
    <link rel="stylesheet" type="text/css" href="../../styles/games/game-counting.css">
    <script src="../../scripts/rem.js"></script>
  </head>
  <body>
    <div class="game-counting-wrap">
      <div class="game-counting">
        <div class="game-counting-innner">
          <img src="../../images/games/header-title.png" width="72%" class="title-img">
          <!-- 剩余次数 -->
          <div class="times">
            <img src="../../images/games/hand-left.png" class="display-inbl" width="7%">
            <p class="display-inbl">剩余游戏次数：5次</p>
          </div>
          <!-- 倒计时 -->
          <div class="count-down">
            <img src="../../images/games/count-down.png" class="display-inbl" width="4.5%" id="hourglass">
            <div class="display-inbl">
              <span class="left">倒计时:</span>
              <div class="process-wrap left">
                <span class="count-tip" id="sub">-5</span>
                <div class="process" id="process-bar"></div>
              </div>
              <span class="left" id="time">30s</span>
            </div>
          </div>
          <!-- 点钞 -->
          <div class="count">
            <div class="count-statistics">
              <p class="display-inbl">9000元 
                <span class="count-tip" id="add-100">+100</span>
                <span class="count-tip" id="add-50">+50</span>
                <span class="icon-rule">活动<br>规则 </span>
              </p>
            </div>
            <div class="count-money">
              <img src="../../images/games/box1.png" width="65%" class="margin display-bl box-top box-top">
              <img src="../../images/games/box2.png" width="61.5%" class="margin display-bl">
              <!-- 钞票列表 -->
              <ul>
                <li><img src="../../images/games/50.png" class="display-bl margin" width="55%"></li>
                <li><img src="../../images/games/100.png" class="display-bl margin" width="55%"></li>
                <li><img src="../../images/games/50.png" class="display-bl margin" width="55%"></li>
              </ul>
              <!-- 点钞按钮 -->
              <div class="btns clear">
                <div class="display-inbl btn-left">
                  <img src="../../images/games/hand.png" width="28%">
                  <span>50</span>
                  <img id="count-50" src="../../images/games/button-50.png" width="41%" onclick="showTip('#add-50')">
                </div>
                <div class="display-inbl btn-right">
                  <img src="../../images/games/hand.png" width="28%">
                  <span>100</span>
                  <img id="count-100" src="../../images/games/button-100.png" class="right" width="41%" onclick="showTip('#add-100')">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
  <script type="text/javascript" src="../../../bower_components/jquery/dist/jquery.min.js"></script>
  <script type="text/javascript">
    $(function () {
      var second = 31,
          countTimer,
          $processBar = $('#process-bar'),
          $time = $('#time'),
          $hourglass = $('#hourglass'),
          percentWidth = 96, // 进度条初始化样式百分比数值
          percentOneSecond = 3.2, // 一秒进度条递减值
          countWrong = false; // 是否数错钞

      // 钱币加减 和 时间减少提示淡入淡出效果 
      var showTip = function (ele) {
        $(ele).fadeIn(800, function () {
          $(ele).fadeOut(1500)
        })
      }

      /*
      ** 倒计时沙漏 
      */
      function hourglassAnimate () {
        $hourglass.addClass('hourglass')
        var glassTimer = setTimeout(function() {
          $hourglass.removeClass('hourglass')
          clearTimeout(glassTimer)
        }, 9900)
      }

      /*
       ** 倒计时进度条和时间效果
       */
      function countDown () {
        // 如果秒数还是大于0，则表示倒计时还没结束
        if (second > 0) {
          // 时间只剩10秒时
          if (second === 10) {
            hourglassAnimate()
          }
          // 判断是否点错，假设在28秒， countWrong === ture 表示点错钞
          if (second === 28) { countWrong = true} else { countWrong = false}
          if (countWrong) {
            second -= 5
            percentWidth -= 16
            showTip('#sub')
          }else {
            second -= 1
            percentWidth -= 3.2
          }
          // 进度条递减
          $processBar.animate({width: percentWidth + '%'}, {duration: 800});
          $time.html(second + 's');
          // 一秒后重复执行
          countTimer = setTimeout(function () {
            countDown();
          }, 1000)
        } else {
          clearTimeout(countTimer)
        }
      }
      countDown();

      // 点钞金额增加提示效果
      function showMoneyTip (clickEle, showEle) {
        var showTip = function (ele) {
          $(ele).fadeIn(800, function () {
            $(ele).fadeOut(1500)
          })
        }
        $(clickEle).on('click', function () {
          showTip(showEle)
        })
      }
      showMoneyTip('#count-100', '#add-100');
      showMoneyTip('#count-50', '#add-50');
      /*
       ** 点钞
       */
      function countStart () {
        
      }
    })
  </script>
</html>